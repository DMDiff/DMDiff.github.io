<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="keywords" content="Metalens, Computational photography, Diffusion model, Spatially varying degradation">
  <meta name="viewport" content="width=device-width*0.6, initial-scale=1">
  <title>DMDiff: Degradation-Modeled Multipath Diffusion for Tunable Metalens Photography</title>

  <!-- <meta name="google-site-verification" content="IYymxWwPaxtVlFH8FLH35zgFoZlGsJb2dLcENRc0unw" /> -->
  <!-- Google tag (gtag.js) -->
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <!-- <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet"> -->

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">
  <script
	type="text/javascript"
    async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML"
  ></script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">

      <div class="navbar-item has-dropdown is-hoverable">
        </div>
      </div>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-2 publication-title">Degradation-Modeled Multipath Diffusion for Tunable Metalens Photography<br></br></h1>
          <div class="is-size-5 publication-authors">

            <span class="author-block">
              <a href="">Jianing Zhang</a><sup>2, 3</sup></span>&nbsp;&nbsp;
            <span class="author-block">
              <a href="">Jiayi Zhu</a><sup>1</sup></span>&nbsp;&nbsp;
            <span class="author-block">
              <a href="">Feiyu Ji</a><sup>1</sup></span>&nbsp;&nbsp;
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=yDEavdMAAAAJ&hl=en">Xiaokang Yang</a><sup>1</sup></span>&nbsp;&nbsp;
            <span class="author-block">
              <a href="https://xiaoyunyuan.net/">Xiaoyun Yuan</a><sup>1</sup></span>&nbsp;&nbsp;
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>MoE Key Lab of Artificial Intelligence, AI Institute, Shanghai Jiao Tong University</span>&nbsp;&nbsp;
            <span class="author-block"><sup>2</sup>Fudan University</span>&nbsp;&nbsp;
            <span class="author-block"><sup>3</sup>Tsinghua University</span>
            <br>
            <span class="email-link">
              <a href="mailto:yuanxiaoyun@sjtu.edu.cn">yuanxiaoyun@sjtu.edu.cn</a>
              &nbsp;&nbsp;
              <!-- <a href="mailto:tonghe90@gmail.com">tonghe90@gmail.com</a> -->
            </span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->

              <span class="link-block">
                <a href="./paper/ICCV2025.pdf"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>

              <span class="link-block">
                <a href="https://arxiv.org/abs/2506.22753"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>

              <span class="link-block">
                <a href="https://github.com/yuanxy92/DMDiff_ICCV2025"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>

            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-four-fifths">
        <img src="./static/images/teaser.png" alt="Main Results">
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Metalenses offer significant potential for ultra-compact computational imaging but face challenges from complex optical degradation and computational restoration difficulties. 
            Existing methods typically rely on precise optical calibration or massive paired datasets, which are non-trivial for real-world imaging systems. Furthermore, a lack of control over the inference process often results in undesirable hallucinated artifacts.
            We introduce Degradation-Modeled Multipath Diffusion for tunable metalens photography, leveraging powerful natural image priors from pretrained models instead of large datasets. Our framework uses positive, neutral, and negative-prompt paths to balance high-frequency detail generation, structural fidelity, and suppression of metalens-specific degradation, alongside <i>pseudo</i> data augmentation. A tunable decoder enables controlled trade-offs between fidelity and perceptual quality. Additionally, a spatially varying degradation-aware attention (SVDA) module adaptively models complex optical and sensor-induced degradation.
            Finally, we design and build a millimeter-scale MetaCamera for real-world validation. Extensive results show that our approach outperforms state-of-the-art methods, achieving high-fidelity and sharp image reconstruction. More materials: <i><a href="https://dmdiff.github.io/">https://dmdiff.github.io/</a></i>.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Method Overview</h2>
        <div class="content has-text-justified">
          <p>
            To tackle the challenges of metalens-based imaging, we propose a degradation-modeled multipath diffusion framework that leverages pretrained large-scale generative diffusion models for tunable metalens photography. Our approach addresses three key challenges: complex metalens degradations, limited paired training data, and hallucinations in generative models.

            With the powerful natural image priors from the base generative diffusion model, our method reconstructs vivid and realistic images using a small training dataset. To further enhance restoration, we propose a Spatially Varying Degradation-Aware (SVDA) attention module, which quantifies optical aberrations and sensor-induced noise to guide the restoration process. Additionally, we introduce a Degradation-modeled Multipath Diffusion (DMDiff) framework, incorporating positive, neutral, and negative-prompt paths to balance detail enhancement and structural fidelity while mitigating metalens-specific distortions. Finally, we design an instantly tunable decoder, enabling dynamic control over reconstruction quality to suppress hallucinations.
          </p>
          <img src="./static/images/multipath_diffusion_model.png" alt="Overview for our method">
          <br><br>
          <img src="./static/images/training_and_inference.png" alt="Overview for our method">
      </div>
    </div>
  </div>
</div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">More Results</h2>
        <div class="content has-text-justified">
          <figure>
            <img src="./static/images/supp_exp_1.png" alt="Qualitative results for our method">
            <figcaption>Qualitative comparisons of different methods on real-world images captured by our system.</figcaption>
          </figure>
        </div>
        <div class="content has-text-justified">
          <figure>
            <img src="./static/images/supp_exp_2.png" alt="Qualitative results for our method">
            <figcaption>Qualitative comparisons of different methods on our unseen test dataset, zoom in for details.</figcaption>
          </figure>
        </div>
        <hr>
        <h2 class="title is-4">Instantly Tunable Decoding demonstration(α:0-1.3)</h2>
        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-6 has-text-centered">
            <img src="./static/images/input_1.png"
                 class="interpolation-image"
                 alt="Interpolate start reference image."/>
            <p>Input</p>
          </div>
          <div class="column interpolation-video-column is-centered">
            <div id="interpolation-image-wrapper" class="is-centered">
              Loading...
            </div>
            <input class="slider is-fullwidth is-large is-info"
                   id="interpolation-slider"
                   step="1" min="0" max="4" value="3" type="range">
          </div>
        </div>
        
        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-6 has-text-centered">
            <img src="./static/images/input_2.png"
                 class="interpolation-image"
                 alt="Interpolate start reference image."/>
            <p>Input</p>
          </div>
          <div class="column interpolation-video-column is-centered">
            <div id="interpolation-image-wrapper2" class="is-centered">
              Loading...
            </div>
            <input class="slider is-fullwidth is-large is-info"
                   id="interpolation-slider2"
                   step="1" min="0" max="4" value="3" type="range">
          </div>
        </div>


        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-6 has-text-centered">
            <img src="./static/images/input_3.png"
                 class="interpolation-image"
                 alt="Interpolate start reference image."/>
            <p>Input</p>
          </div>
          <div class="column interpolation-video-column is-centered">
            <div id="interpolation-image-wrapper3" class="is-centered">
              Loading...
            </div>
            <input class="slider is-fullwidth is-large is-info"
                   id="interpolation-slider3"
                   step="1" min="0" max="4" value="3" type="range">
          </div>
        </div>

        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-6 has-text-centered">
            <img src="./static/images/input_4.png"
                 class="interpolation-image"
                 alt="Interpolate start reference image."/>
            <p>Input</p>
          </div>
          <div class="column interpolation-video-column is-centered">
            <div id="interpolation-image-wrapper4" class="is-centered">
              Loading...
            </div>
            <input class="slider is-fullwidth is-large is-info"
                   id="interpolation-slider4"
                   step="1" min="0" max="4" value="3" type="range">
          </div>
        </div>
      </div>
    </div>
  </div>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>
      @article{zhang2025dmdiff,
        title={Degradation-Modeled Multipath Diffusion for Tunable Metalens Photography},
        author={Jianing Zhang, Jiayi Zhu, Feiyu Ji, Xiaokang Yang, and Xiaoyun Yuan},
        booktitle={arxiv preprint arxiv:2506.22753}, 
        year={2025}
      }
      </code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
        href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            We thank <a href="https://github.com/nerfies/nerfies.github.io" target="_blank">Nerfies</a> for their amazing template.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
